<!DOCTYPE html>
<html>
<head>
  <title>Socket.IO Test Chat</title>
</head>
<body>
  <h2>Test Chat (Web)</h2>

  <input id="room" placeholder="Room ID (example: room1)" />
  <button id="join">Join Room</button>

  <h3>Messages</h3>
  <div id="chat" style="border: 1px solid #333; height: 200px; width: 300px; overflow-y: scroll; padding: 5px;"></div>

  <input id="msg" placeholder="Type message..." />
  <button id="send">Send</button>

  <!-- Load Socket.IO client -->
  <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>

  <script>
    // Connect to server
    const socket = io("http://localhost:3000");

    let currentRoom = null;
    const senderId = "web_user_" + Math.floor(Math.random() * 1000);

    // Join room
    document.getElementById("join").onclick = () => {
      const roomId = document.getElementById("room").value.trim();
      if (!roomId) return alert("Please enter room ID");

      currentRoom = roomId;
      socket.emit("joinRoom", roomId);
      alert("Joined room: " + roomId);
    };

    // Send message
    document.getElementById("send").onclick = () => {
      const message = document.getElementById("msg").value.trim();
      if (!message || !currentRoom) return;

      socket.emit("sendMessage", {
        roomId: currentRoom,
        message,
        senderId
      });

      document.getElementById("msg").value = "";
    };

    // Receive new messages
    socket.on("newMessage", (msg) => {
      const div = document.createElement("div");
      div.textContent = `${msg.senderId}: ${msg.message}`;
      document.getElementById("chat").appendChild(div);
    });
  </script>
</body>
</html>
